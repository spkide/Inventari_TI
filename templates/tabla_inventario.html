<!-- ================== BUSCADOR ================== -->
<div class="mb-3">
  <input type="text"
         id="buscador"
         class="form-control form-control-lg"
         placeholder="ðŸ” Buscar inventario por cualquier campo..."
         autocomplete="off">
</div>

<!-- ================== TABLA DESKTOP ================== -->
<div class="table-responsive d-none d-md-block shadow-sm rounded">
  <table class="table table-striped table-hover align-middle mb-0">
    <thead class="table-dark sticky-top">
      <tr>
        <th>Usuario</th>
        <th>Usuario Servidor</th>
        <th>Correo</th>
        <th>Servidor</th>
        <th>Carpetas</th>
        <th>Equipo</th>
        <th>Marca</th>
        <th>Modelo</th>
        <th>NÂ° Serie</th>
        <th>NÂ° EconÃ³mico</th>
        <th>MAC</th>
        <th class="text-center">Acciones</th>
      </tr>
    </thead>

    <tbody id="tablaBody">
      {% for item in inventario %}
      <tr>
        <td>{{ item.nombre_usuario }}</td>
        <td>{{ item.usuario_servidor }}</td>
        <td>
          <span class="badge bg-primary-subtle text-dark">
            {{ item.correo_usuario }}
          </span>
        </td>
        <td>{{ item.servidor }}</td>
        <td>{{ item.carpetas }}</td>
        <td>{{ item.equipo }}</td>
        <td>{{ item.marca }}</td>
        <td>{{ item.modelo }}</td>
        <td>{{ item.numero_serie }}</td>
        <td>{{ item.numero_economico }}</td>
        <td><code>{{ item.mac }}</code></td>
        <td class="text-center text-nowrap">
          <a href="{{ url_for('edit', id=item.id) }}"
             class="btn btn-sm btn-warning me-1">
            <i class="bi bi-pencil"></i>
          </a>
          <a href="{{ url_for('delete', id=item.id) }}"
             class="btn btn-sm btn-danger"
             onclick="return confirm('Â¿Eliminar registro?')">
            <i class="bi bi-trash"></i>
          </a>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<!-- ================== MODO MÃ“VIL ================== -->
<div class="d-md-none" id="cardsMobile">
  {% for item in inventario %}
  <div class="card mb-3 shadow-sm inventario-card">
    <div class="card-header d-flex justify-content-between align-items-center"
         data-bs-toggle="collapse"
         data-bs-target="#item{{ item.id }}"
         role="button">
      <strong>
        <i class="bi bi-person"></i> {{ item.nombre_usuario }}
      </strong>
      <i class="bi bi-chevron-down"></i>
    </div>

    <div class="collapse" id="item{{ item.id }}">
      <div class="card-body small">
        <p><i class="bi bi-envelope"></i> {{ item.correo_usuario }}</p>
        <p><i class="bi bi-person-badge"></i> {{ item.usuario_servidor }}</p>
        <p><i class="bi bi-server"></i> {{ item.servidor }}</p>
        <p><i class="bi bi-folder"></i> {{ item.carpetas }}</p>
        <p><i class="bi bi-laptop"></i> {{ item.equipo }}</p>
        <p><i class="bi bi-pc-display"></i> {{ item.marca }} â€“ {{ item.modelo }}</p>
        <p><i class="bi bi-upc-scan"></i> {{ item.numero_serie }}</p>
        <p><i class="bi bi-hash"></i> {{ item.numero_economico }}</p>
        <p><i class="bi bi-wifi"></i> <code>{{ item.mac }}</code></p>

        <div class="d-flex gap-2 mt-3">
          <a href="{{ url_for('edit', id=item.id) }}"
             class="btn btn-warning btn-sm w-50">
            <i class="bi bi-pencil"></i> Editar
          </a>
          <a href="{{ url_for('delete', id=item.id) }}"
             class="btn btn-danger btn-sm w-50"
             onclick="return confirm('Â¿Eliminar registro?')">
            <i class="bi bi-trash"></i> Eliminar
          </a>
        </div>
      </div>
    </div>
  </div>
  {% endfor %}
</div>

<!-- ================== BUSCADOR JS (DEBOUNCE) ================== -->
<script>
let timeout;
document.getElementById("buscador").addEventListener("keyup", function () {
  clearTimeout(timeout);
  const filtro = this.value.toLowerCase();

  timeout = setTimeout(() => {
    document.querySelectorAll("#tablaBody tr").forEach(row => {
      row.style.display = row.innerText.toLowerCase().includes(filtro)
        ? ""
        : "none";
    });

    document.querySelectorAll(".inventario-card").forEach(card => {
      card.style.display = card.innerText.toLowerCase().includes(filtro)
        ? ""
        : "none";
    });
  }, 150);
});
</script>

<!-- ================== DARK MODE ================== -->
<style>
.table-responsive {
  max-height: 70vh;
}

@media (prefers-color-scheme: dark) {
  body {
    background-color: #121212;
  }
  .table {
    color: #fff;
  }
  .table-dark {
    background-color: #1f1f1f;
  }
  .card {
    background-color: #1e1e1e;
    color: #fff;
  }
  .card-header {
    background-color: #2a2a2a;
    color: #fff;
  }
}
</style>
