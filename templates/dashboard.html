{% extends "layout.html" %}
{% block content %}
<div class="container-fluid mt-4">
  <h2 class="mb-3"><i class="bi bi-speedometer2"></i> Dashboard de Inventario</h2>
  <hr>

  <!-- Botones -->
  <div class="d-flex flex-column flex-md-row mb-3 gap-2">
    <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#modalAdd">
      <i class="bi bi-plus-circle"></i> Agregar Inventario
    </button>

    <a href="{{ url_for('export_excel') }}" class="btn btn-outline-primary">
      <i class="bi bi-file-earmark-excel"></i> Excel
    </a>
    <a href="{{ url_for('export_pdf') }}" class="btn btn-outline-danger">
      <i class="bi bi-file-earmark-pdf"></i> PDF
    </a>
  </div>

  <!-- Tabla -->
  <div id="tabla-inventario" class="table-responsive">
    {% include 'tabla_inventario.html' %}
  </div>
</div>

<!-- Modal Agregar Inventario -->
<div class="modal fade" id="modalAdd" tabindex="-1">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">
      <form method="post" action="{{ url_for('add') }}">
        <div class="modal-header">
          <h5 class="modal-title">Agregar Inventario</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <div class="row g-2">
            <div class="col-12 col-md-6">
              <input type="text" name="nombre_usuario" class="form-control" placeholder="Nombre del usuario" required>
            </div>
            <div class="col-12 col-md-6">
              <input type="email" name="correo_usuario" class="form-control" placeholder="Correo electrónico" required>
            </div>
            <div class="col-12 col-md-6">
              <input type="text" name="usuario_servidor" class="form-control" placeholder="Usuario del servidor" required>
            </div>
            <div class="col-12 col-md-6">
              <input type="text" name="servidor" class="form-control" placeholder="Servidor" required>
            </div>
            <div class="col-12 col-md-6">
              <input type="text" name="carpetas" class="form-control" placeholder="Carpetas visibles" required>
            </div>
            <div class="col-12 col-md-6">
              <input type="text" name="equipo" class="form-control" placeholder="Equipo (CPU)" required>
            </div>
            <div class="col-12 col-md-6">
              <input type="text" name="marca" class="form-control" placeholder="Marca" required>
            </div>
            <div class="col-12 col-md-6">
              <input type="text" name="modelo" class="form-control" placeholder="Modelo" required>
            </div>
            <div class="col-12 col-md-6">
              <input type="text" name="numero_serie" class="form-control" placeholder="Número de serie" required>
            </div>
            <div class="col-12 col-md-6">
              <input type="text" name="numero_economico" class="form-control" placeholder="Número económico" required>
            </div>
            <div class="col-12 col-md-6">
              <input type="text" name="mac" class="form-control" placeholder="MAC" required>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
          <button class="btn btn-success">Agregar</button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- AJAX para refrescar tabla cada 5 segundos -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
function refrescarTabla() {
  $("#tabla-inventario").load("{{ url_for('tabla_inventario') }}");
}

// Refrescar cada 5 segundos
setInterval(refrescarTabla, 5000);
</script>
{% endblock %}
